# ZAP Baseline Configuration for Prismy
# OWASP ZAP security scanning configuration

# Target URLs to scan
target_url=http://localhost:3000

# Scan scope - include patterns
include_urls=(
  "http://localhost:3000/api/*"
  "http://localhost:3000/dashboard/*"
  "http://localhost:3000/auth/*"
  "http://localhost:3000/translate/*"
  "http://localhost:3000/workspace/*"
)

# Exclude patterns to avoid false positives
exclude_urls=(
  "http://localhost:3000/api/auth/callback/*"
  "http://localhost:3000/_next/*"
  "http://localhost:3000/__nextjs_original-stack-frame"
  "http://localhost:3000/favicon.ico"
  "http://localhost:3000/robots.txt"
)

# Authentication configuration
auth_method="form"
auth_url="http://localhost:3000/auth/signin"
auth_username_field="email"
auth_password_field="password"
auth_username="test@example.com"
auth_password="testpassword123"

# Session management
session_timeout=300

# Scan configuration
scan_level="Medium"  # Low, Medium, High, Insane
alert_threshold="Medium"  # Low, Medium, High

# Specific security checks to enable
passive_scan_rules=(
  "10010"  # Cookie No HttpOnly Flag
  "10011"  # Cookie Without Secure Flag
  "10015"  # Incomplete or No Cache-control and Pragma HTTP Header Set
  "10017"  # Cross-Domain JavaScript Source File Inclusion
  "10020"  # X-Frame-Options Missing
  "10021"  # X-Content-Type-Options Missing
  "10023"  # Information Disclosure - Debug Error Messages
  "10024"  # Information Disclosure - Sensitive Information in URL
  "10025"  # Information Disclosure - Sensitive Information in HTTP Referrer Header
  "10026"  # HTTP Parameter Override
  "10027"  # Information Disclosure - Suspicious Comments
  "10028"  # Open Redirect
  "10029"  # Cookie Poisoning
  "10030"  # User Controllable Charset
  "10031"  # User Controllable HTML Element Attribute (Potential XSS)
  "10032"  # Viewstate Scanner
  "10033"  # Directory Browsing
  "10034"  # Heartbleed OpenSSL Vulnerability
  "10035"  # Strict-Transport-Security Missing
  "10036"  # HTTP Server Response Header
  "10037"  # Server Leaks Information via "X-Powered-By" HTTP Response Header
  "10038"  # Content Security Policy (CSP) Header Not Set
  "10039"  # X-Backend-Server Header Information Leak
  "10040"  # Secure Pages Include Mixed Content
  "10041"  # HTTP to HTTPS Insecure Transition in Form Post
  "10042"  # HTTPS to HTTP Insecure Transition in Form Post
  "10043"  # User Controllable JavaScript Event (XSS)
  "10044"  # Big Redirect Detected (Potential Sensitive Information Leak)
  "10045"  # Source Code Disclosure - /WEB-INF folder
  "10046"  # Source Code Disclosure - /META-INF folder
  "10047"  # Source Code Disclosure - File Inclusion
  "10048"  # ShellShock
  "10049"  # Content Cacheability
  "10050"  # Retrieved from Cache
  "10051"  # Relative Path Confusion
  "10052"  # X-ChromeLogger-Data (XCOLD) Header Information Leak
  "10053"  # Apache Range Header DoS (CVE-2011-3192)
  "10054"  # Cookie Without SameSite Attribute
  "10055"  # CSP Scanner
  "10056"  # X-Debug-Token Information Leak
  "10057"  # Username Hash Found
  "10058"  # GET for POST
  "10059"  # X-AspNet-Version Response Header
  "10060"  # Proxy Disclosure
  "10061"  # X-Powered-By Information Disclosure
  "10062"  # PII Scanner
  "10063"  # Feature Policy Header Not Set
  "10096"  # Timestamp Disclosure
  "10097"  # Hash Disclosure
  "10098"  # Cross-Domain Misconfiguration
  "10099"  # Source Code Disclosure
  "10105"  # Weak Authentication Method
  "10108"  # Reverse Tabnabbing
  "10109"  # Modern Web Application
  "10110"  # Dangerous JS Functions
  "10202"  # Absence of Anti-CSRF Tokens
)

# Active scan rules for API endpoints
active_scan_rules=(
  "40012"  # Cross Site Scripting (Reflected)
  "40014"  # Cross Site Scripting (Persistent)
  "40016"  # Cross Site Scripting (Persistent) - Prime
  "40017"  # Cross Site Scripting (Persistent) - Spider
  "40018"  # SQL Injection
  "40019"  # SQL Injection - MySQL
  "40020"  # SQL Injection - Hypersonic SQL
  "40021"  # SQL Injection - Oracle
  "40022"  # SQL Injection - PostgreSQL
  "40023"  # Possible Username Enumeration
  "40024"  # SQL Injection - SQLite
  "40025"  # Proxy Disclosure
  "40026"  # Cross Site Scripting (DOM Based)
  "40027"  # SQL Injection - MsSQL
  "40028"  # CRLF Injection
  "40029"  # LDAP Injection
  "40030"  # XPATH Injection
  "40031"  # XML External Entity Attack
  "40032"  # NoSQL Injection - MongoDB
  "40033"  # Directory Traversal
  "40034"  # Path Traversal
  "40035"  # Hidden File Finder
  "40036"  # Server Side Include
  "40037"  # Remote File Inclusion
  "40038"  # Cross Site Scripting (Persistent) - OkHttp
  "40039"  # ELMAH Information Leak
  "40040"  # Source Code Disclosure - Git
  "40041"  # Source Code Disclosure - SVN
  "40042"  # Source Code Disclosure - File Inclusion
  "40043"  # Source Code Disclosure - WEB-INF
  "40044"  # Source Code Disclosure - CVE-2012-1823
  "40045"  # Source Code Disclosure - htaccess
  "40046"  # Source Code Disclosure - /crossdomain.xml
  "40047"  # Remote Code Execution - CVE-2012-1823
  "90001"  # Insecure JSF ViewState
  "90011"  # Charset Mismatch
  "90017"  # XSLT Injection
  "90019"  # Server Side Code Injection
  "90020"  # Remote OS Command Injection
  "90021"  # XPath Injection
  "90022"  # Expression Language Injection
  "90023"  # XML External Entity Attack
  "90024"  # Generic Padding Oracle
  "90025"  # Expression Language Injection
  "90026"  # SOAP Action Spoofing
  "90027"  # Cookie Slack Detector
  "90028"  # Insecure HTTP Method
  "90029"  # SOAP XML Injection
  "90030"  # WSDL File Detection
  "90033"  # Loosely Scoped Cookie
)

# Report configuration
report_format="json,html,xml"
report_dir="/zap/wrk/reports"

# Performance settings
max_children=10
max_scan_time_in_mins=60