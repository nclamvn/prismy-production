# ZAP Rules Configuration for Prismy
# Custom security scanning rules for Vietnamese translation platform

# Authentication Configuration
rules.authentication.auto=true
rules.authentication.method=form
rules.authentication.loginUrl=http://localhost:3000/auth/signin
rules.authentication.usernameParameter=email
rules.authentication.passwordParameter=password
rules.authentication.loginPageIndicator=Sign in
rules.authentication.loggedInIndicator=Dashboard
rules.authentication.loggedOutIndicator=Sign in

# Session Management
rules.session.method=cookie
rules.session.sessionTokens=next-auth.session-token,__Secure-next-auth.session-token

# Anti-CSRF Settings
rules.csrf.anti-csrf=true
rules.csrf.tokens=csrf_token,authenticity_token,_token

# Spider Configuration
spider.maxDepth=5
spider.maxChildren=20
spider.requestWaitTime=200
spider.acceptCookies=true
spider.handleODataParametersVisited=false
spider.handleParameters=use-all
spider.maxDuration=10
spider.maxParseSizeBytes=2621440
spider.maxScansInUI=5
spider.postForm=true
spider.processForm=true
spider.parseComments=true
spider.parseGit=false
spider.parseRobotsTxt=true
spider.parseSVNEntries=false
spider.parseSitemapXml=true
spider.sendRefererHeader=true
spider.skipURLString=
spider.userAgent=ZAP

# Active Scanner Settings
scanner.level=MEDIUM
scanner.strength=MEDIUM
scanner.attackOnStart=false
scanner.maxResultsToList=1000
scanner.maxRuleDurationInMins=0
scanner.maxScanDurationInMins=60
scanner.delayInMs=0
scanner.hostsPerScan=1
scanner.threadsPerHost=2

# Passive Scanner Settings
pscanner.level=MEDIUM

# Global exclude patterns
globalexclude.url1=.*\\.js$
globalexclude.url2=.*\\.css$
globalexclude.url3=.*\\.png$
globalexclude.url4=.*\\.jpg$
globalexclude.url5=.*\\.jpeg$
globalexclude.url6=.*\\.gif$
globalexclude.url7=.*\\.ico$
globalexclude.url8=.*\\.svg$
globalexclude.url9=.*/_next/.*
globalexclude.url10=.*/__nextjs_original-stack-frame.*

# Context-specific rules for Prismy
context.name=PrismyContext
context.incRegexes=http://localhost:3000.*
context.excRegexes=http://localhost:3000/_next/.*,http://localhost:3000/api/auth/callback/.*

# Technology detection
tech.detect=true

# Custom header rules for Next.js
rules.requestheader.header1=X-Requested-With:XMLHttpRequest
rules.requestheader.header2=Accept:application/json

# Rate limiting
rules.rateLimit.requestsPerSecond=10
rules.rateLimit.enabled=true

# Vietnamese locale specific settings
rules.locale=vi-VN
rules.encoding=UTF-8
rules.currency=VND

# Payment security rules (for VNPay, MoMo integration)
rules.payment.sensitive=true
rules.payment.patterns=vnp_,momo_,payment_,card_,bank_

# API security rules
rules.api.json=true
rules.api.rest=true
rules.api.cors=check